# Code Conductor Testing Framework

## Overview

This testing framework provides a comprehensive and automated approach to testing the Code Conductor CLI tool (v0.4.5). It includes:

1. **Automatic Test Discovery**: Finds and categorizes tests throughout the codebase
2. **Test Categorization**: Organizes tests by type (simple, integration, unit, etc.)
3. **Flexible Test Selection**: Run specific tests, categories, or all tests
4. **Detailed Reporting**: Generates markdown reports with test results
5. **Non-interactive Mode**: Ensures tests can run in CI/CD environments without user input

## Components

The testing framework consists of several core components:

- `test_discovery.sh`: Discovers and categorizes tests in the codebase
- `test_catalog.sh`: Generated by the discovery script, contains lists of tests by category
- `test_runner.sh`: Contains the core logic for running tests
- `test_reporting.sh`: Handles test result reporting
- `test_types.sh`: Contains functions for running specific test types
- `test_utils.sh`: Common utility functions
- `run_all_tests.sh`: Main script that ties everything together
- `create_test_work_effort.sh`: Script for creating work efforts in non-interactive mode

## How to Use

### Basic Usage

To run all tests:

```bash
./run_all_tests.sh
```

To run only simple tests (faster and more reliable):

```bash
./run_all_tests.sh --simple
```

To run with verbose output:

```bash
./run_all_tests.sh -v
```

### Advanced Usage

Run tests from a specific category:

```bash
./run_all_tests.sh -c simple
./run_all_tests.sh -c unit
./run_all_tests.sh -c integration
./run_all_tests.sh -c cli
```

Run a specific test:

```bash
./run_all_tests.sh -t simple-help
```

Set maximum execution time for tests:

```bash
./run_all_tests.sh -m 60
```

### Available Categories

- `shell`: All shell-based tests
- `python`: All Python-based tests
- `simple`: Basic tests that are quick and reliable
- `integration`: Tests that verify component interactions
- `unit`: Tests for individual units of code
- `command`: Tests for specific CLI commands
- `performance`: Tests that evaluate system performance
- `cli`: Tests specifically for CLI functionality

## Adding New Tests

### Simple Tests

1. Create a new file named `simple_[test_name].sh`
2. Follow the pattern in existing simple tests
3. Make the file executable with `chmod +x simple_[test_name].sh`
4. Run the test discovery to update the catalog: `./test_discovery.sh -g`

### Python Tests

1. Create a new file in the `tests/` directory named `test_[name].py`
2. Use Python's unittest framework
3. Run the test discovery to update the catalog

## Reports

Test reports are generated in the `test_reports/` directory with timestamped filenames. Each report includes:

- Environment details
- Test results with pass/fail status
- Execution time for each test
- Output from each test
- Summary statistics

## Implementation Details

### Test Discovery

The discovery system scans the codebase for test files using pattern matching, then categorizes them based on their content and naming conventions. Categories are determined by:

- File naming patterns (e.g., `simple_*.sh` for simple tests)
- Content analysis (e.g., checking for "integration test" in the file)
- Location (e.g., tests in the `tests/` directory)

### Test Execution

Tests are executed with timeout protection to prevent hanging. Shell scripts are modified on-the-fly to run in non-interactive mode.

### Test Reporting

Reports are generated in Markdown format with detailed information about each test run.

## CI/CD Integration

The testing framework is designed to work seamlessly in CI/CD environments:

### Non-interactive Work Effort Creation

The CLI has been enhanced with a non-interactive mode that allows creating work efforts without user prompts:

```bash
python3 cli.py work --title "Test Results" --description "Test run results" --priority medium -y
```

You can also use the provided script:

```bash
./create_test_work_effort.sh
```

### GitHub Actions Integration

To run these tests in GitHub Actions, add the following to your workflow:

```yaml
name: Run Tests

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.10'
      - name: Install dependencies
        run: pip install -r requirements.txt
      - name: Run tests
        run: ./run_all_tests.sh --simple
      - name: Create work effort for test results
        run: ./create_test_work_effort.sh
```

## Future Enhancements

Planned improvements to the testing framework:

1. Support for parallel test execution
2. Code coverage reporting
3. Automated test generation based on code changes
4. Integration with more CI/CD systems